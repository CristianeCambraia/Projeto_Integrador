{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>
        {% if titulo_pagina %}
            {{ titulo_pagina }} | INSUMED
        {% else %}
            INSUMED
        {% endif %}
    </title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        nav ul {
            display: flex;
            align-items: center;
            height: 100%;
        }
        nav ul li {
            display: flex;
            align-items: center;
        }
        nav ul li a {
            display: flex;
            align-items: center;
            height: 100%;
            font-size: 20px;
        }
        .notification-bell {
            position: relative;
            display: flex;
            align-items: center;
        }
        .bell-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            position: relative;
        }
        /* CSS preparado para contador de notifica√ß√µes */
        .notification-count {
            position: absolute;
            top: 2px;
            right: 2px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            min-width: 16px;
            height: 16px;
            font-size: 10px;
            display: none; /* Oculto por padr√£o */
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .notification-count.show {
            display: flex;
        }
        
        /* Dropdown de notifica√ß√µes */
        .notification-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            width: 350px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .notification-dropdown.show {
            display: block;
        }
        
        .notification-header {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }
        
        .notification-header h3 {
            margin: 0;
            font-size: 16px;
            color: #333;
        }
        
        .notification-filters {
            padding: 10px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            gap: 5px;
        }
        
        .filter-btn {
            padding: 5px 10px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .notification-list {
            max-height: 250px;
            overflow-y: auto;
        }
        
        .notification-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .notification-item:hover {
            background-color: #f8f9fa;
        }
        
        .notification-item:last-child {
            border-bottom: none;
        }
        
        .notification-content {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .notification-icon {
            font-size: 18px;
            margin-top: 2px;
        }
        
        .notification-text {
            flex: 1;
        }
        
        .notification-title {
            font-weight: bold;
            font-size: 13px;
            color: #333;
            margin-bottom: 3px;
        }
        
        .notification-message {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }
        
        .notification-time {
            font-size: 11px;
            color: #999;
            margin-top: 5px;
        }
        
        .notification-empty {
            padding: 30px 15px;
            text-align: center;
            color: #666;
            font-size: 14px;
        }
        
        .notification-actions {
            padding: 10px 15px;
            border-top: 1px solid #eee;
            text-align: center;
        }
        
        .mark-all-read {
            background: none;
            border: none;
            color: #007bff;
            font-size: 12px;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Padroniza√ß√£o de tamanho para todas as telas */
        @media screen {
            .container, .form-container, .lista-container, .emitir-orcamento-container, .container-lista-orcamentos, .suporte-container {
                max-width: 95% !important;
                width: 95% !important;
                margin: 20px auto 0 auto !important;
            }
        }

    </style>
</head>
<body>
    <header>
        <div class="logo-header">
            <img src="{% static 'images/insumed_icon.png' %}" alt="insumed_icon">
            <h1 class="insumed">INSUMED</h1>
        </div>

        <nav>
            <ul>
                {% if admin_logado %}
                    <li><a href="{% url 'lista_suporte' %}">Suporte</a></li>
                    <li><a href="{% url 'admin_logout' %}">Sair Admin</a></li>
                {% else %}
                    <li><a href="/">Home</a></li>
                    <li><a href="{% url 'fornecedores' %}">Cadastros</a></li>
                    <li><a href="{% url 'emitir_orcamento' %}">Or√ßamentos</a></li>
                    <li><a href="{% url 'relatorio_estoque' %}">Relat√≥rios</a></li>
                    <li><a href="{% url 'balancete' %}">Balancete</a></li>
                    {% if usuario_logado %}
                        <li><a href="{% url 'logout' %}">Sair</a></li>
                        <li style="position: relative;">
                            <button onclick="toggleNotifications()" style="background: none; border: none; cursor: pointer; font-size: 24px; position: relative; filter: hue-rotate(200deg);">
                                üîî
                                <span id="notificationCounter" style="position: absolute; top: 2px; right: 2px; background: #ff4444; color: white; border-radius: 50%; min-width: 16px; height: 16px; font-size: 10px; display: flex; align-items: center; justify-content: center; font-weight: bold;">10</span>
                            </button>
                            
                            <div id="notificationDropdown" style="display: none; position: fixed; top: 80px; right: 20px; background: white; border: 1px solid #ccc; width: 320px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 99999;">
                                <h3 style="margin: 0 0 10px 0; color: #333;">Notifica√ß√µes de Estoque</h3>
                                
                                <div style="border-bottom: 1px solid #eee; padding: 10px 0; margin: 5px 0; cursor: pointer; background: #f8f9fa; border-radius: 5px; padding: 10px;" onclick="expandCategory('VALIDADE')">
                                    <strong>‚ö†Ô∏è Produto pr√≥ximo da validade (4)</strong>
                                    <div id="items-VALIDADE" style="display: none; margin-top: 10px; padding-left: 20px;">
                                        <div id="notif-1" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(1); window.location.href='/notificacao/1/VALIDADE/'">
                                            <strong>Medicamento A</strong><br>
                                            <small>Vence em 15 dias</small>
                                        </div>
                                        <div id="notif-2" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(2); window.location.href='/notificacao/2/VALIDADE/'">
                                            <strong>Medicamento B</strong><br>
                                            <small>Vence em 30 dias</small>
                                        </div>
                                        <div id="notif-5" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(5); window.location.href='/notificacao/5/VALIDADE/'">
                                            <strong>Insulina Regular</strong><br>
                                            <small>Vence em 8 dias</small>
                                        </div>
                                        <div id="notif-6" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(6); window.location.href='/notificacao/6/VALIDADE/'">
                                            <strong>Soro Fisiol√≥gico</strong><br>
                                            <small>Vence em 25 dias</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="border-bottom: 1px solid #eee; padding: 10px 0; margin: 5px 0; cursor: pointer; background: #f8f9fa; border-radius: 5px; padding: 10px;" onclick="expandCategory('ESTOQUE_CRITICO')">
                                    <strong>üî¥ Estoque cr√≠tico (3)</strong>
                                    <div id="items-ESTOQUE_CRITICO" style="display: none; margin-top: 10px; padding-left: 20px;">
                                        <div id="notif-3" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(3); window.location.href='/notificacao/3/ESTOQUE_CRITICO/'">
                                            <strong>Produto C</strong><br>
                                            <small>Apenas 2 unidades</small>
                                        </div>
                                        <div id="notif-7" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(7); window.location.href='/notificacao/7/ESTOQUE_CRITICO/'">
                                            <strong>M√°scara N95</strong><br>
                                            <small>Apenas 1 unidade</small>
                                        </div>
                                        <div id="notif-8" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(8); window.location.href='/notificacao/8/ESTOQUE_CRITICO/'">
                                            <strong>Luvas Cir√∫rgicas</strong><br>
                                            <small>Apenas 3 unidades</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 10px 0; margin: 5px 0; cursor: pointer; background: #f8f9fa; border-radius: 5px; padding: 10px;" onclick="expandCategory('BAIXA_SAIDA')">
                                    <strong>üì¶ Baixa sa√≠da (3)</strong>
                                    <div id="items-BAIXA_SAIDA" style="display: none; margin-top: 10px; padding-left: 20px;">
                                        <div id="notif-4" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(4); window.location.href='/notificacao/4/BAIXA_SAIDA/'">
                                            <strong>Produto D</strong><br>
                                            <small>Sem sa√≠da h√° 90 dias</small>
                                        </div>
                                        <div id="notif-9" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(9); window.location.href='/notificacao/9/BAIXA_SAIDA/'">
                                            <strong>Term√¥metro Digital</strong><br>
                                            <small>Sem sa√≠da h√° 120 dias</small>
                                        </div>
                                        <div id="notif-10" style="border-bottom: 1px solid #ddd; padding: 5px 0; margin: 5px 0; cursor: pointer; background: white; padding: 8px; border-radius: 3px;" onclick="event.stopPropagation(); markAsRead(10); window.location.href='/notificacao/10/BAIXA_SAIDA/'">
                                            <strong>Estetosc√≥pio</strong><br>
                                            <small>Sem sa√≠da h√° 150 dias</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            

                        </li>
                    {% else %}
                        <li><a href="{% url 'cadastrar_usuario' %}">Cadastrar Usu√°rio</a></li>
                        <li><a href="{% url 'login' %}">Login</a></li>
                    {% endif %}
                {% endif %}
            </ul>
        </nav>
    </header>

    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer>
        <div>
            <p class="Rede-social">Redes Sociais</p>
            <ul class="social-media">
                <li><a href="https://wa.me/5535997548034" target="_blank"><img src="{% static 'images/whatsapp.svg' %}" alt="WhatsApp"></a></li>
                <li><a href="https://instagram.com/insumed" target="_blank"><img src="{% static 'images/instagram.svg' %}" alt="Instagram"></a></li>
                <li><a href="https://facebook.com/insumed" target="_blank"><img src="{% static 'images/facebook.svg' %}" alt="Facebook"></a></li>
            </ul>
        </div>
        <div style="text-align: center; flex: 1;">
            <p>Todos os direitos reservados &copy;</p>
            <p>Develop By: Bessa, Cristiane, Eduardo, Leonardo, Lucas.</p>
            <p>Telefone - (35) 98412-3236</p>
        </div>

        {% if not admin_logado %}
        <ul class="contact">
            <li><a href="{% url 'sobre_nos' %}">Sobre n√≥s</a></li>
            <li><a href="{% url 'criar_suporte' %}">Contato</a></li>
        </ul>
        {% endif %}
    </footer>

    <script>

        

        

        

        
        function toggleNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            if (dropdown.style.display === 'block') {
                dropdown.style.display = 'none';
            } else {
                dropdown.style.display = 'block';
            }
        }
        
        function expandCategory(tipo) {
            const itemsDiv = document.getElementById(`items-${tipo}`);
            
            if (itemsDiv.style.display === 'none') {
                itemsDiv.style.display = 'block';
            } else {
                itemsDiv.style.display = 'none';
            }
        }
        
        function markAsRead(notifId) {
            // Salvar no localStorage
            let readNotifications = JSON.parse(localStorage.getItem('readNotifications') || '[]');
            if (!readNotifications.includes(notifId)) {
                readNotifications.push(notifId);
                localStorage.setItem('readNotifications', JSON.stringify(readNotifications));
                
                // Atualizar contador
                updateNotificationCounter();
                
                // Marcar visualmente como lida
                const notifElement = document.getElementById(`notif-${notifId}`);
                if (notifElement) {
                    notifElement.style.opacity = '0.5';
                    notifElement.style.backgroundColor = '#f0f0f0';
                }
            }
        }
        
        function updateNotificationCounter() {
            const readNotifications = JSON.parse(localStorage.getItem('readNotifications') || '[]');
            const totalNotifications = 10;
            const unreadCount = totalNotifications - readNotifications.length;
            
            const counter = document.getElementById('notificationCounter');
            if (counter) {
                counter.textContent = unreadCount;
                if (unreadCount === 0) {
                    counter.style.display = 'none';
                } else {
                    counter.style.display = 'flex';
                }
            }
        }
        
        function initializeNotifications() {
            const readNotifications = JSON.parse(localStorage.getItem('readNotifications') || '[]');
            
            // Marcar notifica√ß√µes j√° lidas
            readNotifications.forEach(notifId => {
                const notifElement = document.getElementById(`notif-${notifId}`);
                if (notifElement) {
                    notifElement.style.opacity = '0.5';
                    notifElement.style.backgroundColor = '#f0f0f0';
                }
            });
            
            // Atualizar contador
            updateNotificationCounter();
        }
        
        // Inicializar ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            initializeNotifications();
        });
        
        // Fechar dropdown ao clicar fora
        document.addEventListener('click', function(event) {
            const bell = event.target.closest('li');
            const dropdown = document.getElementById('notificationDropdown');
            
            if (dropdown && !bell) {
                dropdown.style.display = 'none';
            }
        });
    </script>
</body>
</html>
